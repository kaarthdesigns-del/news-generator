const canvas = document.getElementById("canvas");
const ctx = canvas.getContext("2d");

let bgImage = null;

document.getElementById("imageUpload").addEventListener("change", function(e){
  const reader = new FileReader();
  reader.onload = function(event){
    bgImage = new Image();
    bgImage.onload = render;
    bgImage.src = event.target.result;
  };
  reader.readAsDataURL(e.target.files[0]);
});

document.getElementById("headline").addEventListener("input", render);

function render(){

  ctx.clearRect(0,0,1080,1350);

  if(bgImage){
    ctx.drawImage(bgImage,0,0,1080,1350);
  }

  // Black Fade
  const gradient = ctx.createLinearGradient(0,750,0,1350);
  gradient.addColorStop(0,"rgba(0,0,0,0)");
  gradient.addColorStop(1,"rgba(0,0,0,0.95)");
  ctx.fillStyle = gradient;
  ctx.fillRect(0,0,1080,1350);

  ctx.fillStyle = "white";
  ctx.font = "60px Arial";

  const text = document.getElementById("headline").value;
  ctx.fillText(text, 100, 950);
}

function downloadImage(){
  const link = document.createElement("a");
  link.download = "canvas-test.png";
  link.href = canvas.toDataURL("image/png");
  link.click();
}



